C **********************************************************************
C Function to compute the ANN : 3-15-7-1-sigmoid yield stress
C **********************************************************************
      subroutine vuhard (
C Read only -
     +  nblock, nElement, nIntPt, nLayer, nSecPt, lAnneal, stepTime,
     +  totalTime, dt, cmname, nstatev, nfieldv, nprops, props,
     +  tempOld, tempNew, fieldOld, fieldNew, stateOld, eqps, eqpsRate,
C Write only -
     +  yield, dyieldDtemp, dyieldDeqps, stateNew)
C
      include 'vaba_param.inc'
C
      dimension nElement(nblock), props(nprops), tempOld(nblock),
     +  fieldOld(nblock,nfieldv), stateOld(nblock,nstatev),
     +  tempNew(nblock), fieldNew(nblock,nfieldv), eqps(nblock),
     +  eqpsRate(nblock), yield(nblock), dyieldDtemp(nblock),
     +  dyieldDeqps(nblock,2), stateNew(nblock,nstatev)
C
      character*80 cmname
C
      do k = 1, nblock
C xepsp = (eqps(k) - minEntries[0]) / rangeEntries[0]
      xepsp = (eqps(k) - 0.0)/1.0
C xdepsp = (log(depsp/logBase) - minEntries[1]) / rangeEntries[1]
      xdepsp = (log(eqpsRate(k)/1.0) - 0.0)/10.819778284410
C xtemp = (temp - minEntries[2]) / rangeEntries[2]
      xtemp = (tempNew(k) - 20.0)/480.0
C za = np.exp(-w1.dot(x)  -  b1)
      za0 = exp(0.171193018556*xepsp + 0.498235881329*xdepsp -
     +  1.572309255600*xtemp + 0.549710810184)
      za1 = exp(0.182183891535*xepsp + 0.279642552137*xdepsp -
     +  1.381547451019*xtemp + 1.007667899132)
      za2 = exp(0.121008850634*xepsp + 0.093622177839*xdepsp +
     +  1.284856081009*xtemp - 1.146428942680)
      za3 = exp(-0.677952528000*xepsp - 0.785129725933*xdepsp +
     +  3.600407361984*xtemp + 1.056580066681)
      za4 = exp(8.224933624268*xepsp - 0.102857425809*xdepsp +
     +  1.170001864433*xtemp + 0.834357798100)
      za5 = exp(0.262212038040*xepsp + 0.370604902506*xdepsp -
     +  1.530593752861*xtemp + 0.557993113995)
      za6 = exp(-0.363313168287*xepsp - 0.307944297791*xdepsp +
     +  1.739808201790*xtemp + 0.515264987946)
      za7 = exp(0.171282619238*xepsp + 0.936020970345*xdepsp +
     +  0.700896143913*xtemp + 0.525115251541)
      za8 = exp(2.934058904648*xepsp - 0.024969343096*xdepsp +
     +  0.818501532078*xtemp - 0.164255663753)
      za9 = exp(0.298778355122*xepsp + 0.517931699753*xdepsp +
     +  7.580852508545*xtemp + 1.864312648773)
      za10 = exp(-1.177027940750*xepsp + 0.308994054794*xdepsp +
     +  1.684179663658*xtemp + 0.859441757202)
      za11 = exp(0.231339216232*xepsp + 0.290423154831*xdepsp -
     +  1.502451419830*xtemp + 1.198348641396)
      za12 = exp(-235.784103393555*xepsp + 0.099293000996*xdepsp -
     +  0.760096788406*xtemp - 0.819592595100)
      za13 = exp(23.344444274902*xepsp - 0.164729803801*xdepsp +
     +  0.949119210243*xtemp + 0.500462353230)
      za14 = exp(-0.329279005527*xepsp - 0.054267201573*xdepsp +
     +  1.555212616920*xtemp + 0.580829739571)
C zb = 1 + za
      zb0 = 1.0 + za0
      zb1 = 1.0 + za1
      zb2 = 1.0 + za2
      zb3 = 1.0 + za3
      zb4 = 1.0 + za4
      zb5 = 1.0 + za5
      zb6 = 1.0 + za6
      zb7 = 1.0 + za7
      zb8 = 1.0 + za8
      zb9 = 1.0 + za9
      zb10 = 1.0 + za10
      zb11 = 1.0 + za11
      zb12 = 1.0 + za12
      zb13 = 1.0 + za13
      zb14 = 1.0 + za14
C zc = w2.dot(zb) + b2
      zc0 = exp(-0.000755758665/zb0 -
     +  0.348879784346/zb1 +
     +  1.622294902802/zb2 +
     +  1.744126558304/zb3 -
     +  1.189603447914/zb4 -
     +  0.773437738419/zb5 +
     +  1.077992796898/zb6 -
     +  0.195966541767/zb7 -
     +  0.371459305286/zb8 +
     +  2.175866603851/zb9 -
     +  0.267415910959/zb10 -
     +  0.117423757911/zb11 +
     +  1.837396621704/zb12 +
     +  1.631284832954/zb13 +
     +  0.915312469006/zb14 +
     +  0.220450609922)
      zc1 = exp(1.520736217499/zb0 +
     +  0.598750412464/zb1 +
     +  0.567928969860/zb2 -
     +  0.733987450600/zb3 +
     +  1.956816315651/zb4 +
     +  0.990542054176/zb5 +
     +  0.024108286947/zb6 +
     +  0.921862065792/zb7 +
     +  1.585801959038/zb8 +
     +  0.359389543533/zb9 +
     +  0.568457961082/zb10 +
     +  0.462055325508/zb11 -
     +  0.937371969223/zb12 -
     +  0.713293492794/zb13 +
     +  0.270313948393/zb14 +
     +  0.580874204636)
      zc2 = exp(0.263961493969/zb0 -
     +  0.340663641691/zb1 +
     +  1.086898207664/zb2 +
     +  0.190290063620/zb3 -
     +  1.526942133904/zb4 -
     +  0.134074971080/zb5 +
     +  0.458628684282/zb6 +
     +  0.210141628981/zb7 -
     +  0.690639853477/zb8 +
     +  0.559289455414/zb9 +
     +  0.561830639839/zb10 -
     +  0.010643188842/zb11 +
     +  2.779141187668/zb12 -
     +  2.203900575638/zb13 +
     +  0.874182760715/zb14 +
     +  0.327307760715)
      zc3 = exp(1.667145609856/zb0 +
     +  1.261272549629/zb1 +
     +  1.568691968918/zb2 +
     +  1.300865530968/zb3 +
     +  0.965722560883/zb4 +
     +  1.076323390007/zb5 +
     +  0.399949252605/zb6 +
     +  2.976247072220/zb7 +
     +  3.980113983154/zb8 +
     +  1.212576389313/zb9 +
     +  0.478132873774/zb10 +
     +  1.447541594505/zb11 +
     +  0.287288188934/zb12 +
     +  0.847129225731/zb13 +
     +  0.899507462978/zb14 +
     +  0.965191483498)
      zc4 = exp(0.421280384064/zb0 +
     +  0.564329922199/zb1 -
     +  1.009604096413/zb2 -
     +  0.335408806801/zb3 +
     +  0.515781700611/zb4 +
     +  0.189889833331/zb5 -
     +  0.561685442924/zb6 +
     +  0.274590790272/zb7 +
     +  0.640589475632/zb8 +
     +  0.454831272364/zb9 -
     +  0.185221791267/zb10 +
     +  1.204036474228/zb11 -
     +  2.715961456299/zb12 +
     +  2.415366411209/zb13 -
     +  0.508277475834/zb14 -
     +  0.001537762932)
      zc5 = exp(1.879916071892/zb0 +
     +  1.522165775299/zb1 +
     +  0.468759000301/zb2 -
     +  1.417994260788/zb3 -
     +  0.370010912418/zb4 +
     +  2.718472957611/zb5 -
     +  0.469961762428/zb6 +
     +  2.314279079437/zb7 +
     +  0.682480514050/zb8 +
     +  1.616387128830/zb9 -
     +  0.202725619078/zb10 +
     +  1.451031565666/zb11 -
     +  0.099444560707/zb12 +
     +  1.293660640717/zb13 -
     +  0.203722134233/zb14 +
     +  0.991643249989)
      zc6 = exp(0.589749693871/zb0 +
     +  0.571380496025/zb1 -
     +  0.120540380478/zb2 -
     +  0.763658463955/zb3 +
     +  1.608781814575/zb4 +
     +  0.913990020752/zb5 -
     +  0.719076871872/zb6 +
     +  1.206779360771/zb7 +
     +  0.747950553894/zb8 +
     +  0.689776837826/zb9 +
     +  0.001232341980/zb10 +
     +  0.592846393585/zb11 -
     +  1.381900072098/zb12 -
     +  0.327141195536/zb13 -
     +  0.125081762671/zb14 +
     +  0.179510131478)
C y = w3.dot(xd) + b3
      y =-1.147175073624/(1.0 + zc0) +
     +  0.396453082561/(1.0 + zc1) -
     +  1.731730222702/(1.0 + zc2) +
     +  0.341490298510/(1.0 + zc3) +
     +  0.917140424252/(1.0 + zc4) +
     +  0.416720062494/(1.0 + zc5) +
     +  0.469032645226/(1.0 + zc6) -
     +  0.399738907814
C zd = w3v*(xd / (1 + zc)**2)
      zd0 =-1.147175073624*(zc0/(1.0 + zc0)**2)
      zd1 = 0.396453082561*(zc1/(1.0 + zc1)**2)
      zd2 =-1.731730222702*(zc2/(1.0 + zc2)**2)
      zd3 = 0.341490298510*(zc3/(1.0 + zc3)**2)
      zd4 = 0.917140424252*(zc4/(1.0 + zc4)**2)
      zd5 = 0.416720062494*(zc5/(1.0 + zc5)**2)
      zd6 = 0.469032645226*(zc6/(1.0 + zc6)**2)
C ze = za / (1 + za)**2
      ze0 = za0 / zb0**2
      ze1 = za1 / zb1**2
      ze2 = za2 / zb2**2
      ze3 = za3 / zb3**2
      ze4 = za4 / zb4**2
      ze5 = za5 / zb5**2
      ze6 = za6 / zb6**2
      ze7 = za7 / zb7**2
      ze8 = za8 / zb8**2
      ze9 = za9 / zb9**2
      ze10 = za10 / zb10**2
      ze11 = za11 / zb11**2
      ze12 = za12 / zb12**2
      ze13 = za13 / zb13**2
      ze14 = za14 / zb14**2
C zf = (w2.T).dot(zd) * xd
      zf0 = (0.000755758665*zd0 -
     +  1.520736217499*zd1 -
     +  0.263961493969*zd2 -
     +  1.667145609856*zd3 -
     +  0.421280384064*zd4 -
     +  1.879916071892*zd5 -
     +  0.589749693871*zd6)*ze0
      zf1 = (0.348879784346*zd0 -
     +  0.598750412464*zd1 +
     +  0.340663641691*zd2 -
     +  1.261272549629*zd3 -
     +  0.564329922199*zd4 -
     +  1.522165775299*zd5 -
     +  0.571380496025*zd6)*ze1
      zf2 = (-1.622294902802*zd0 -
     +  0.567928969860*zd1 -
     +  1.086898207664*zd2 -
     +  1.568691968918*zd3 +
     +  1.009604096413*zd4 -
     +  0.468759000301*zd5 +
     +  0.120540380478*zd6)*ze2
      zf3 = (-1.744126558304*zd0 +
     +  0.733987450600*zd1 -
     +  0.190290063620*zd2 -
     +  1.300865530968*zd3 +
     +  0.335408806801*zd4 +
     +  1.417994260788*zd5 +
     +  0.763658463955*zd6)*ze3
      zf4 = (1.189603447914*zd0 -
     +  1.956816315651*zd1 +
     +  1.526942133904*zd2 -
     +  0.965722560883*zd3 -
     +  0.515781700611*zd4 +
     +  0.370010912418*zd5 -
     +  1.608781814575*zd6)*ze4
      zf5 = (0.773437738419*zd0 -
     +  0.990542054176*zd1 +
     +  0.134074971080*zd2 -
     +  1.076323390007*zd3 -
     +  0.189889833331*zd4 -
     +  2.718472957611*zd5 -
     +  0.913990020752*zd6)*ze5
      zf6 = (-1.077992796898*zd0 -
     +  0.024108286947*zd1 -
     +  0.458628684282*zd2 -
     +  0.399949252605*zd3 +
     +  0.561685442924*zd4 +
     +  0.469961762428*zd5 +
     +  0.719076871872*zd6)*ze6
      zf7 = (0.195966541767*zd0 -
     +  0.921862065792*zd1 -
     +  0.210141628981*zd2 -
     +  2.976247072220*zd3 -
     +  0.274590790272*zd4 -
     +  2.314279079437*zd5 -
     +  1.206779360771*zd6)*ze7
      zf8 = (0.371459305286*zd0 -
     +  1.585801959038*zd1 +
     +  0.690639853477*zd2 -
     +  3.980113983154*zd3 -
     +  0.640589475632*zd4 -
     +  0.682480514050*zd5 -
     +  0.747950553894*zd6)*ze8
      zf9 = (-2.175866603851*zd0 -
     +  0.359389543533*zd1 -
     +  0.559289455414*zd2 -
     +  1.212576389313*zd3 -
     +  0.454831272364*zd4 -
     +  1.616387128830*zd5 -
     +  0.689776837826*zd6)*ze9
      zf10 = (0.267415910959*zd0 -
     +  0.568457961082*zd1 -
     +  0.561830639839*zd2 -
     +  0.478132873774*zd3 +
     +  0.185221791267*zd4 +
     +  0.202725619078*zd5 -
     +  0.001232341980*zd6)*ze10
      zf11 = (0.117423757911*zd0 -
     +  0.462055325508*zd1 +
     +  0.010643188842*zd2 -
     +  1.447541594505*zd3 -
     +  1.204036474228*zd4 -
     +  1.451031565666*zd5 -
     +  0.592846393585*zd6)*ze11
      zf12 = (-1.837396621704*zd0 +
     +  0.937371969223*zd1 -
     +  2.779141187668*zd2 -
     +  0.287288188934*zd3 +
     +  2.715961456299*zd4 +
     +  0.099444560707*zd5 +
     +  1.381900072098*zd6)*ze12
      zf13 = (-1.631284832954*zd0 +
     +  0.713293492794*zd1 +
     +  2.203900575638*zd2 -
     +  0.847129225731*zd3 -
     +  2.415366411209*zd4 -
     +  1.293660640717*zd5 +
     +  0.327141195536*zd6)*ze13
      zf14 = (-0.915312469006*zd0 -
     +  0.270313948393*zd1 -
     +  0.874182760715*zd2 -
     +  0.899507462978*zd3 +
     +  0.508277475834*zd4 +
     +  0.203722134233*zd5 +
     +  0.125081762671*zd6)*ze14
C yd = (w1.T).dot(zf)
      yd0 =-0.171193018556*zf0 -
     +  0.182183891535*zf1 -
     +  0.121008850634*zf2 +
     +  0.677952528000*zf3 -
     +  8.224933624268*zf4 -
     +  0.262212038040*zf5 +
     +  0.363313168287*zf6 -
     +  0.171282619238*zf7 -
     +  2.934058904648*zf8 -
     +  0.298778355122*zf9 +
     +  1.177027940750*zf10 -
     +  0.231339216232*zf11 +
     +  235.784103393555*zf12 -
     +  23.344444274902*zf13 +
     +  0.329279005527*zf14
      yd1 =-0.498235881329*zf0 -
     +  0.279642552137*zf1 -
     +  0.093622177839*zf2 +
     +  0.785129725933*zf3 +
     +  0.102857425809*zf4 -
     +  0.370604902506*zf5 +
     +  0.307944297791*zf6 -
     +  0.936020970345*zf7 +
     +  0.024969343096*zf8 -
     +  0.517931699753*zf9 -
     +  0.308994054794*zf10 -
     +  0.290423154831*zf11 -
     +  0.099293000996*zf12 +
     +  0.164729803801*zf13 +
     +  0.054267201573*zf14
      yd2 = 1.572309255600*zf0 +
     +  1.381547451019*zf1 -
     +  1.284856081009*zf2 -
     +  3.600407361984*zf3 -
     +  1.170001864433*zf4 +
     +  1.530593752861*zf5 -
     +  1.739808201790*zf6 -
     +  0.700896143913*zf7 -
     +  0.818501532078*zf8 -
     +  7.580852508545*zf9 -
     +  1.684179663658*zf10 +
     +  1.502451419830*zf11 +
     +  0.760096788406*zf12 -
     +  0.949119210243*zf13 -
     +  1.555212616920*zf14
      Yield(k) = 977.555715042962*y + 579.184642915415
      dyieldDeqps(k,1) = 977.555715042962*yd0
      dyieldDeqps(k,2) = 90.348959964501*yd1 / eqpsRate(k)
      dyieldDtemp(k) = 2.036574406340*yd2
      end do
C
      return
      end
